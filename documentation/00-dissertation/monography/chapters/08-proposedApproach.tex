\chapter{Abordagem Proposta} \label{chap:propApproach}
	\section{Coleta de dados}
		\par Para a realização desta pesquisa coletou-se uma série de vozes nos arredores do Instituto de Biociências, Letras e Ciências Exatas em São José do Rio Preto no estado de São Paulo. Foram coletadas amostras de 21 Indivíduos, das quais 20 foram usadas já que, em um dos casos, não foi possível coletar todos os dados necessários. Tais gravações se constituem de dígitos em um intervalo de 0 a 9 falados tanto em língua inglesa como em portuguesa. Os locutores foram escolhidos de acordo com seu sexo e idade de forma que a amostra estudada tenha uma abrangência que cubra desde crianças em época pré-escolar até adultos entre 50 e 60 anos do sexo masculino e feminino.
					
		\par As gravações foram feitas em ambientes distintos com diferentes níveis de ruído ao fundo garantindo uma boa variabilidade de interferências que certamente impactaram nos resultados dos classificadores usados.
		
		\par Coletadas as amostras, os dígitos das mesmas foram separados um-a-um usando uma ferramenta desenvolvida para esse fim, resultando em uma base de dados com 820 trechos.
		
	\section{Formato dos dados}
		\par Foram usados arquivos no formato \textit{wave} \textit{pulse-code modulation} (PCM), neste esquema, fora os descartes de informação que ocorrem pela da discretização do sinal. Os dados são armazenados sem perdas significativas para a análise necessária, já que não são empregados métodos de corte nas frequências ou outro método de compactação destrutiva.
		
		\par A taxa de amostragem escolhida foi de 44100hz, que permite, segundo o teorema de Nyquist, que seja realizada a quantização de frequências de até 22050hz, bem acima do máximo medido nas escalas escolhidas. A resolução dos valores é de 16bits.
		
		\subsection{Áudios originais}
			\par Para a constituição da base de dados não regravada os áudios originais foram editados e separados digito a dígito.

		\subsection{Áudios regravados}
			\par No caso da base usada para simulação de \textit{voice spoofing} foi criado um arquivo contendo todas as falas de todos os entrevistados, em seguida, os sons reproduzidos por este foram regravados por um segundo dispositivo de gravação diferente do original.

	\section{Organização da base de dados}
		\par A organização da base de dados se deu por tipo (regravado ou não), idioma, dígito ditado e interlocutor considerado. Foi criada uma estrutura hierárquica de diretórios de forma a permitir que fosse fácil e intuitivo acessar cada uma das amostras seja por vias automatizadas ou não. Os arquivos regravados residem no diretório "playback" \ já os não regravados se encontram em "live".	Essa organização é mostrada nas figuras \ref{fig:directorystructlevel01}, \ref{fig:directorystructlevel02} e \ref{fig:directorystructlevel03}.
		
		\par Para facilitar a automação do processamento foram criados três arquivos de texto:
		\begin{itemize}
			\item \textit{\textbf{dataSurvey.txt}}: Contêm os dados de idade e sexo e nome do arquivo gerado para cada entrevistado.
			\item \textit{\textbf{inputListLive.txt}}: Uma lista de caminhos para todos os arquivo não regravados.
			\item \textit{\textbf{inputListSpoofing.txt}}: Apresenta uma listagem dos caminhos para todos os arquivos regravados.
		\end{itemize}
	
		\par Apenas para ilustrar, o conteúdo do diretório \textbf{"separated \textfractionsolidus live \textfractionsolidus en\_US \textfractionsolidus 0"} se constitui de vários arquivos do tipo \textit{wave} cada um identificando o locutor ao qual pertence como mostrado na  figura \ref{fig:directorystructlevel03}.
			
		\begin{figure}
			\centering
			\subfloat[0.3\textwidth][Base em nível 1]{
				\includegraphics{images/directoryStructLevel01}
				\label{fig:directorystructlevel01}
			}
			\subfloat[0.3\textwidth][Base em nível 2]{
				\includegraphics{images/directoryStructLevel02}
				\label{fig:directorystructlevel02}
			}
			\subfloat[0.3\textwidth][Base em nível 3]{
				\includegraphics{images/directoryStructLevel03}
				\label{fig:directorystructlevel03}
			}
			\caption{Organização da base de dados}
			\label{fig:directorystructlevel010203}
		\end{figure}
	
	\section{Wavelets}
		\par Como já explanado no capítulo \ref{chap:revBibli}, neste trabalho apenas as transformadas diretas serão realizadas já que, neste contexto, não interessa a reconstrução do sinal. A abordagem usada será baseada nos filtros de análise digitais que proporcionarão a decomposição do sinal com o uso de filtros passa baixas e passa altas estritamente no domínio discreto.

		\subsection{Wavelets testadas}
			\par Nós experimentos explicados mais a  frente foram testadas as seguintes wavelets:
			\begin{multicols}{5}
				\begin{itemize}
					\item haar		\item daub4		\item daub6		\item daub8
					\item daub10	\item daub12	\item daub14	\item daub16
					\item daub18	\item daub20	\item daub22	\item daub24
					\item daub26	\item daub28	\item daub30	\item daub32
					\item daub34	\item daub36	\item daub38	\item daub40
					\item daub42	\item daub44	\item daub46	\item daub48
					\item daub50	\item daub52	\item daub54	\item daub56
					\item daub58	\item daub60	\item daub62	\item daub64
					\item daub66	\item daub68	\item daub70	\item daub72
					\item daub74	\item daub76	\item sym8		\item sym16
					\item sym32		\item coif6		\item coif12	\item coif18
					\item coif24	\item coif30	\item beylkin18	\item vaidyanathan24
				\end{itemize}
			\end{multicols}

	\section{Experimentos}
		\subsection{Experimento 01 - Melhor combinação Wavelet x BARK ou MEL}
		\label{chap:propApproach:sec:Experimento01}
			\subsubsection{Apresentação}
				\par O objetivo desse experimento verificar, segundo análise paraconsistente, qual das combinações entre as escalas BARK ou MEL e as várias \textit{wavelets} consideradas geram os vetores de características com menos sobreposição (disjuntos).
				
				\par Mais informações sobre a análise paraconsistente se encontram no capítulo \ref{chap:revBibli}. 
				
				\par O uso de \textit{wavelets} geralmente tem como objetivo a geração de vetores que serão analisados ou processados posteriormente, tais sequências de valores carregam a informação de frequência e tempo que podem ser úteis para uma análise específica. Neste trabalho a decomposição foi feita até seu limite  para que, após isso, fosse executada a soma das energias nos intervalos definidos pela escala BARK e MEL que seriam impossíveis, ou imprecisas se assim não se precedesse. Por fim, foram  feitos os posicionamentos dos resultados no plano paraconsistente.
				
				\par O algoritmo \ref{lst:experiment01Algo} demonstra a realização dessas etapas.
			
			\subsubsection{Redimensionando o sinal}
				\par Antes da aplicação da transformada \textit{wavelet} é necessário redimensionar o sinal para que este tenha um comprimento correspondente a uma potência de 2 como indicado na equação \ref{eq:optimalSize}. Isso é necessário para que não haja perdas de informação ao final da transformação, pois, como a transformada \textit{wavelet} realiza o \textit{downsampling} numa ordem de 2, ou seja, em cada nível o tamanho do vetor do sinal é diminuído pela metade. Caso haja um comprimento diferente do citado, em alguma parte do processo a divisão não será inteira fazendo com que algum/alguns valores dentro do processamento não sejam considerados.
				
				\par Na equação \ref{eq:optimalSize} \textit{\textbf{proxInt}} é uma função que retorna o próximo número inteiro dado outro real (por exemplo, $proxInt(1,5) = 2$) e \textit{\textbf{tamanho}} é a quantidade de itens no vetor do sinal.

				\begin{equation}
					tamanhoOtimo=2^{proxInt(\log_{2}tamanho)}
					\label{eq:optimalSize}
				\end{equation} 
			
			\subsubsection{Determinando o número máximo de transformações}
				\par Após o redimensionamento do sinal a quantidade máxima de transformações necessárias para reduzir os coeficientes a um vetor unitário é dada pela equação \ref{eq:maxWaveletTransf}. 
				
				\begin{equation}
					maxTrans=\log_{2}tamanho
					\label{eq:maxWaveletTransf}
				\end{equation}


			\subsubsection{Algoritmo}
			\input{codeListings/experiment01Algo.tex}

		\subsection{Experimento 02 - Desempenho da combinação mais disjunta em classificadores por distância}
		\label{chap:propApproach:sec:Experimento02}
			\subsubsection{Apresentação}
				\par O objetivo deste é verificar, considerando as melhores combinações descobertas pelo experimento 1, o desempenho de classificadores por distâncias Euclidiana e Manhattan. Nesta fase do estudo os vetores de características gerados pelo experimento 1 são fornecidos aos classificadores cujos desempenhos serão medidos.
				
				\par Objetivando mensurar o comportamento da classificação com diversos tamanhos para os modelos de referência, o tamanho dos mesmos foi definido segundo porcentagens da quantidade total de amostras.
				
				\par Para cada porcentagem escolhida o experimento deve ser executado uma vez, depois duas vezes, após isso 3, 4, 5, até que se chegue a execução de um número definido de testes. A quantidade total de testes realizados é dado pela equação \ref{eq:amountOftests}. Em cada uma dessas execuções, a ordem dos vetores dentro das amostras (\textit{spoofing} e não \textit{spoofing}) foi permutada aleatoriamente para evitar que uma coincidência afetasse os valores dos resultados.
				
				\par Abaixo: \textit{\textbf{numTestes}} representa número máximo de testes que podem ser feitos usando uma certa porcentagem.
				\begin{equation}
					\label{eq:amountOftests}
					qtdeTotalDeTestes= numTestes * \dfrac{numTestes + 1}{2}
				\end{equation}
				
				\par Para cada porcentagem foram coletadas as melhores e as piores acurácias assim como suas respectivas matrizes de confusão.
				
				\par No algoritmo \ref{lst:experiment02Algo} é explicado as etapas do experimento.
								
			\subsubsection{Amostragem}
				\par Houve uma separação entre amostras para teste e outras constituir o modelo de referência para o classificador. Os modelos de referência foram dimensionados usando-se 10\%, 20\%, 30\%, 40\% e 50\% da quantidade total de amostras para ambas as classes (\textit{spoofing} e não \textit{spoofing}) as restantes foram usadas nos testes.	
			\subsubsection{Algoritmo}
			\input{codeListings/experiment02Algo.tex}

		\subsection{Experimento 03 - Desempenho da combinação mais disjunta em uma SVM}
		\label{chap:propApproach:sec:Experimento03}
			\subsubsection{Apresentação}
				\par Considerando as melhores combinações descobertas pelo experimento 1, nesta parte pretende-se medir o desempenho de uma \textit{Support Vector Machine} (SVM). Nesta fase do estudo os vetores de características gerados pelo experimento 1 são fornecidos ao classificador cujo desempenho será medido. São idênticas ao experimento 2 as quantidades de testes, as formas de separação dos conjuntos de modelo e teste (amostragem), assim como boa porção da lógica, esta, será apresentada apenas como garantia do entendimento e se encontra no algoritmo \ref{lst:experiment03Algo}.

			\subsubsection{Algoritmo}
				\input{codeListings/experiment03Algo.tex}

		\subsection{Experimento 04 - Análise das \textit{wavelets}}
		\label{chap:propApproach:sec:Experimento04}
			\subsubsection{Apresentação}
				\par Verificando o comportamento das melhores e piores \textit{wavelets} encontradas, este experimento visa entender a razão que faz \textbf{Haar} a melhor escolha para este tipo de análise.
				\par Os experimentos \ref{chap:propApproach:sec:Experimento01}, \ref{chap:propApproach:sec:Experimento02}, \ref{chap:propApproach:sec:Experimento03} mostraram que a combinação \textbf{\textit{wavelet packet haar + escala BARK}} é a melhor para geração de vetores de características e que esses possibilitam um desempenho razoável com classificadores simples. Esse experimento visa responder, qual o motivo dessa combinação funcionar melhor em se tratando da decomposição feita pelas \textit{wavelets}.
				\par As \textit{wavelets} \textbf{haar} e \textbf{daubechies 42} foram escolhidas pois conseguiram respectivamente os melhores e os piores vetores de características na escala \textit{BARK}. Já em \textit{MEL}, \textbf{haar} foi a melhor e \textbf{daubechies 54} a pior. Tais valores provém do experimento \ref{chap:propApproach:sec:Experimento01}, mais especificamente das tabelas \ref{tab:distParacomFrom10Bark_1},  \ref{tab:distParacomFrom10Bark_2},  \ref{tab:distParacomFrom10Mel_1} e 	\ref{tab:distParacomFrom10Mel_2} no apêndice deste documento.
				
			\subsubsection{Base de comparação}
				\par Para fins comparativos, foi criado um sinal periódico sobre o qual serão aplicadas as transformadas \textit{wavelet} correspondentes aos melhores e piores desempenhos, os resultados dessa aplicação, assim como o sinal original, constituem um gráfico comparativo.
				\par O sinal periódico foi construído com a sequência \textit{32, 10, 20, 38, 37, 28, 38, 34, 18, 24, 24, 9, 23, 24, 28, 34} repetida 32 vezes totalizando um total de 512 posições. Considerando a abordagem de decomposição máxima, foram aplicadas as transformadas \textit{wavelet packet} até o nível 8.
			\subsubsection{Comparativo}
				\par O comparativo foi feito em um gráfico gerado a partir das transformadas \textit{wavelet packet} supracitadas no qual se pode notar as diferenças entre os sinais gerados.
			\subsubsection{Algoritmo}
				\input{codeListings/experiment04Algo.tex}

		\subsection{Experimento 05 - Comparação da escalas BARK e MEL}
		\label{chap:propApproach:sec:Experimento05}
			\subsubsection{Apresentação}
				\par Por fim, nesta parte foram verificados os desempenhos das escalas combinadas com suas respectivas \textit{wavelets}, novamente tais dados foram retirados do experimento \ref{chap:propApproach:sec:Experimento01}.
				\par A geração dos vetores de características foi feita utilizando-se a base de dados já constituída e os mesmos algoritmos de análise com uma pequena diferença: \textbf{A derivação} dos sinais, realizada na finalização da escala \textbf{MEL}, foi \textbf{desativada} para que fosse possível analisar os valores gerados dentro dos seus intervalos que, de outro modo, seriam diminuídos em dois.

				\par O objetivo aqui é mostrar por quê a escala \textbf{BARK} fornece um conjunto melhor de vetores de características dentro do contexto da análise de \textit{voice spoofing}.

			\subsubsection{Comparativo}
				\par O comparativo foi feito em vários gráficos de dispersão que aglutinam os intervalos das escalas em eixos verticais. 
				\par As combinações \textit{wavelet packet + escalas BARK ou MEL} e sinais \textit{spoofing}/\textit{não spoofing} geram, cada uma, um gráfico.